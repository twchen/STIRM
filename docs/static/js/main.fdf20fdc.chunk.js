(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{37:function(e,t,n){e.exports=n(58)},58:function(e,t,n){"use strict";n.r(t);var a=n(3),r=n(13),o=n(10),s=n(32),i=n(18),c=function(e){return{type:"SET_ACTIVE_COMPONENT",component:e}},l=Object(r.b)({activeComponent:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Welcome",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_ACTIVE_COMPONENT":return t.component;default:return e}},dataset:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_DATASET":return t.dataset;default:return e}},attributes:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_DATASET":return t.attributes;default:return e}},candidates:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CANDIDATES":return t.candidates;default:return e}},mask:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_DATASET":var n={};return t.attributes.forEach(function(e){var t=Object(a.a)(e,2),r=t[0];t[1],n[r]=1}),n;case"TOGGLE_MASK":return Object(s.a)({},e,t.mask);default:return e}},numQuestions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;switch((arguments.length>1?arguments[1]:void 0).type){case"RESTART":return 0;case"INCREMENT_QCOUNT":return e+1;default:return e}},prunedPoints:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"RESTART":return[];case"PRUNE_POINTS":return[].concat(Object(o.a)(t.points),Object(o.a)(e));default:return e}},leftPoints:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_LEFT_POINTS":return t.points;case"PRUNE_POINTS":return e.filter(function(e){return!t.indices.includes(e[0])});default:return e}},numLeftPoints:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_LEFT_POINTS":return[t.points.length];case"PRUNE_POINTS":var n=e[e.length-1];return[].concat(Object(o.a)(e),[n-t.points.length]);default:return e}},mode:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"simplex",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_MODE":return t.mode;default:return e}},vertices:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_CONVEX_HULL":return t.vertices;default:return e}}}),u=n(1),m=n.n(u),d=n(34),h=n(2),p=n(4),f=n(5),v=n(8),E=n(6),b=n(7),g=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(v.a)(this,Object(E.a)(t).call(this,e))).handleStart=function(){for(var e=new window.Module.Ranges,t=new window.Module.VectorInt,r=/^\d+$/,o=0;o<n.props.attributes.length;++o){var s=Object(a.a)(n.props.attributes[o],2),i=s[0],c=s[1],l=[c.low,c.high];if(n.props.mask[i])for(var u=0;u<2;++u){var m=n.inputs[i][u].current.value.trim();if(""!==m){if(!r.test(m))return void alert("".concat(m," in ").concat(i," range is not an integer"));l[u]=parseInt(m)}}e.push_back(l),t.push_back(n.props.mask[i])}var d=1e3,h=n.inputs.maxPoints.current.value.trim();""!==h&&r.test(h)&&(d=parseInt(h));var p=n.props.dataset.selectCandidates(e,t,d);if(0===p.size())return window.Module.releasePoints(p),void alert("No matching cars, try larger ranges");n.props.startAlgorithm(p)},n.handleModeChange=function(e){n.props.changeMode(e.target.value)},n.inputs={},n.props.attributes.forEach(function(e){var t=Object(a.a)(e,2),r=t[0];t[1];n.inputs[r]=[m.a.createRef(),m.a.createRef()]}),n.inputs.maxPoints=m.a.createRef(),n}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this,t=this.props.attributes.map(function(t){var n=Object(a.a)(t,2),r=n[0],o=n[1],s=0===e.props.mask[r],i=o.low,c=o.high;return m.a.createElement("tr",{key:r},m.a.createElement("td",{className:"align-middle"},r),m.a.createElement("td",null,m.a.createElement("input",{type:"text",className:"form-control",placeholder:i,ref:e.inputs[r][0],disabled:s})),m.a.createElement("td",null,m.a.createElement("input",{type:"text",className:"form-control",placeholder:c,ref:e.inputs[r][1],disabled:s})),m.a.createElement("td",{className:"align-middle hidden"},m.a.createElement("input",{type:"checkbox",checked:s,onChange:function(){return e.props.toggleMask(r,1-e.props.mask[r])}})))});return m.a.createElement("div",{className:"text-center m-auto",style:{maxWidth:"50rem"}},m.a.createElement("h1",null,"Find Your Favorite!"),m.a.createElement("p",{className:"lead text-muted"},"This is a demostration of an interactive system for finding your favorite car in a used car database. ",m.a.createElement("br",null),"Enter your acceptable range for each attribute (leave blank to use the default). ",m.a.createElement("br",null),"You will be presented two cars each time and you need to choose the one you favor more. ",m.a.createElement("br",null),'Click the "Start" button to find your favorite car in the database! ',m.a.createElement("br",null)),m.a.createElement("table",{className:"table"},m.a.createElement("thead",null,m.a.createElement("tr",null,m.a.createElement("th",{className:"align-middle"},"Attribute"),m.a.createElement("th",null,"Lower bound"),m.a.createElement("th",null,"Upper bound"),m.a.createElement("th",{className:"hidden"},"Discard"))),m.a.createElement("tbody",null,t)),m.a.createElement("form",null,m.a.createElement("div",{className:"form-group row align-items-center"},m.a.createElement("div",{className:"col-6"},m.a.createElement("div",{className:"row align-items-center"},m.a.createElement("label",{htmlFor:"maxPoints",className:"col-4 col-form-label"},"Max No. of Cars"),m.a.createElement("div",{className:"col"},m.a.createElement("input",{type:"text",className:"form-control",id:"maxPoints",placeholder:"1000",ref:this.inputs.maxPoints})))),m.a.createElement("div",{className:"col-6"},m.a.createElement("div",{className:"row align-items-center"},m.a.createElement("label",{className:"col-4 col-form-label"},"Mode"),m.a.createElement("div",{className:"col text-left"},m.a.createElement("div",{className:"form-check form-check-inline"},m.a.createElement("input",{className:"form-check-input",type:"radio",name:"inlineRadioOptions",id:"simplex",value:"simplex",checked:"simplex"===this.props.mode,onChange:this.handleModeChange}),m.a.createElement("label",{className:"form-check-label",htmlFor:"simplex"},"Simplex")),m.a.createElement("div",{className:"form-check form-check-inline"},m.a.createElement("input",{className:"form-check-input",type:"radio",name:"inlineRadioOptions",id:"random",value:"random",checked:"random"===this.props.mode,onChange:this.handleModeChange}),m.a.createElement("label",{className:"form-check-label",htmlFor:"random"},"Random")))))),m.a.createElement("div",{className:"form-group row"},m.a.createElement("div",{className:"col"},m.a.createElement("button",{type:"button",className:"btn btn-primary",style:{width:"8rem"},onClick:this.handleStart},"Start")))))}}]),t}(m.a.Component),y=Object(h.b)(function(e){return{attributes:e.attributes,mask:e.mask,dataset:e.dataset,mode:e.mode}},function(e){return{startAlgorithm:function(t){e(function(e){return{type:"SET_CANDIDATES",candidates:e}}(t)),e(c("Interaction"))},toggleMask:function(t,n){return e(function(e,t){return{type:"TOGGLE_MASK",mask:Object(i.a)({},e,t)}}(t,n))},changeMode:function(t){return e(function(e){return{type:"SET_MODE",mode:e}}(t))}}})(g),w=2,N=1;function O(e){for(var t=[],n=0;n<e.dim();++n)t.push(e.get(n));return t}function k(e){for(var t=[],n=0;n<e.size();++n)t.push(O(e.get(n)));return t}var j=function(e){function t(e){var n;Object(p.a)(this,t),(n=Object(v.a)(this,Object(E.a)(t).call(this,e))).choose=function(e){var t=e+1;n.runner.choose(t);var a=window.Module.read_convex_hull_vertices();n.props.updateConvexHull(a);var r=n.runner.getCandidatesIndices(),s=function(e,t){for(var n=[],a=0,r=0;a<e.size()||r<t.size();)r>=t.size()||e.get(a)<t.get(r)?(n.push(e.get(a)),++a):(++a,++r);return n}(n.prevIndices,r),i=s.map(function(e){var t=n.props.candidates.get(e);return[e,n.props.numQuestions+1].concat(Object(o.a)(O(t)))});if(n.props.prunePoints(i,s),n.prevIndices=r,n.props.incrementQCount(),n.prevIndices.size()<2)n.stopInteraction();else{var c=k(n.runner.nextPair());n.setState({pair:c})}},n.stopInteraction=function(){window.Module.releasePoints(n.props.candidates),n.props.showResult()};var r=new window.Module.VectorInt;n.attributes=[],n.props.attributes.forEach(function(e){var t=Object(a.a)(e,2),o=t[0],s=t[1];n.props.mask[o]&&(r.push_back(s.smallerBetter?1:0),n.attributes.push(o))}),n.runner=new window.Module.AlgorithmRunner(n.props.candidates,r,"random"===n.props.mode?N:w),n.prevIndices=n.runner.getCandidatesIndices();for(var s=[],i=0;i<n.prevIndices.size();++i){var c=n.prevIndices.get(i),l=n.props.candidates.get(c),u=[c].concat(Object(o.a)(O(l)));s.push(u)}if(n.props.setLeftPoints(s),s.length<2)n.state={pair:[]},n.stopInteraction();else{var m=window.Module.read_convex_hull_vertices();n.props.updateConvexHull(m),n.state={pair:k(n.runner.nextPair())}}return n}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this,t=[m.a.createElement("th",{key:"Option No."},"Option")];this.attributes.forEach(function(e){t.push(m.a.createElement("th",{key:e},e))}),t.push(m.a.createElement("th",{key:"chooseButton"}));var n=this.state.pair.map(function(t,n){var a=[m.a.createElement("td",{key:"Option No."},n+1)];return t.forEach(function(e,t){a.push(m.a.createElement("td",{key:t},e))}),a.push(m.a.createElement("td",{key:"chooseButton"},m.a.createElement("button",{type:"button",className:"btn btn-outline-success btn-sm",onClick:function(){return e.choose(n)}},"Choose"))),m.a.createElement("tr",{key:n},a)});return m.a.createElement("div",null,m.a.createElement("h4",null,"Q",this.props.numQuestions+1,": Choose the Car You Favor More among the Following Options"),m.a.createElement("div",{className:"row justify-content-center align-items-center"},m.a.createElement("div",{className:"col-md-8"},m.a.createElement("table",{className:"table table-hover text-center"},m.a.createElement("thead",null,m.a.createElement("tr",null,t)),m.a.createElement("tbody",null,n))),m.a.createElement("div",{className:"col-md-2"},m.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:this.stopInteraction},"Stop"))))}}]),t}(m.a.Component);var C=Object(h.b)(function(e){return{candidates:e.candidates,mask:e.mask,attributes:e.attributes,numQuestions:e.numQuestions,mode:e.mode}},function(e){return{showResult:function(){e(c("Result"))},incrementQCount:function(){e({type:"INCREMENT_QCOUNT"})},setLeftPoints:function(t){e({type:"SET_LEFT_POINTS",points:t})},prunePoints:function(t,n){e(function(e,t){return{type:"PRUNE_POINTS",points:e,indices:t}}(t,n))},updateConvexHull:function(t){e(function(e){return{type:"UPDATE_CONVEX_HULL",vertices:e}}(function(e){if(e.size()<1||e.get(0).size()<2)return[];for(var t=[],n=0;n<e.size();++n){for(var a=e.get(n),r=[],o=0;o<a.size()-1;++o)r.push(a.get(o));t.push(r)}return t}(t)))}}})(j),P=n(12),T=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(v.a)(this,Object(E.a)(t).call(this,e)))._onMouseLeave=function(){n.setState({hintValue:null})},n._onNearestX=function(e,t){var a=t.index;n.setState({hintValue:n.props.data[a]})},n.state={hintValue:null},n}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return m.a.createElement(P.e,{onMouseLeave:this._onMouseLeave,height:400,width:400},m.a.createElement(P.d,{tickValues:this.props.data.map(function(e,t){return t}),tickFormat:function(e){return e.toString()}}),m.a.createElement(P.f,null),m.a.createElement(P.a,{text:"Question No.",includeMargin:!1,xPercent:.82,yPercent:1.06}),m.a.createElement(P.a,{text:"No. of Cars Left",includeMargin:!1,xPercent:-.01,yPercent:.05,style:{transform:"rotate(-90)",textAnchor:"end"}}),m.a.createElement(P.c,{color:"rgb(0, 123, 255)",onNearestX:this._onNearestX,data:this.props.data,animation:!0}),this.state.hintValue&&m.a.createElement(P.b,{value:this.state.hintValue},m.a.createElement("p",{style:{color:"rgb(90, 90, 90)"}},"Q",this.state.hintValue.x,": ",this.state.hintValue.y," Cars Left")))}}]),t}(m.a.Component),x=Object(h.b)(function(e){return{data:e.numLeftPoints.map(function(e,t){return{x:t,y:e}})}})(T);var S=Object(h.b)(function(e){return{leftPoints:e.leftPoints,attributes:e.attributes,mask:e.mask,numQuestions:e.numQuestions}},function(e){return{restart:function(){e(c("Welcome")),e({type:"RESTART"})}}})(function(e){var t=e.leftPoints,n=e.attributes,r=e.mask,o=e.numQuestions,s=e.restart,i=[];n.forEach(function(e){var t=Object(a.a)(e,2),n=t[0];if(t[1],r[n]){var o=m.a.createElement("th",{key:n},n);i.push(o)}});var c=t.map(function(e,t){return m.a.createElement("tr",{key:t},e.slice(1).map(function(e,t){return m.a.createElement("td",{key:t},e)}))});return m.a.createElement("div",{className:"row justify-content-center"},m.a.createElement("div",{className:"col"},m.a.createElement("h4",null,"The Total No. of Questions Asked is: ",o,"."),m.a.createElement("h4",null,1===t.length?"Your Favourite Car is:":"".concat(t.length," Cars Left in the Database:")),m.a.createElement("table",{className:"table table-hover text-center"},m.a.createElement("thead",null,m.a.createElement("tr",null,i)),m.a.createElement("tbody",null,c)),m.a.createElement("div",{className:"d-flex justify-content-center"},m.a.createElement(x,null)),m.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:s},"Return to Welcome")))}),_=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(v.a)(this,Object(E.a)(t).call(this,e))).attributes=[],n.props.attributes.forEach(function(e){var t=Object(a.a)(e,2),r=t[0];t[1];n.props.mask[r]&&n.attributes.push(r)}),n}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=[m.a.createElement("th",{key:"Step No."},"Step")];this.attributes.forEach(function(t){e.push(m.a.createElement("th",{key:t},t))});var t=this.props.prunedPoints.map(function(e,t){return m.a.createElement("tr",{key:t},e.slice(1).map(function(e,t){return m.a.createElement("td",{key:t},e)}))}),n=this.props.leftPoints.map(function(e,t){return m.a.createElement("tr",{key:t},e.slice(1).map(function(e,t){return m.a.createElement("td",{key:t},e)}))});return m.a.createElement("div",{className:"row"},m.a.createElement("div",{className:"col"},m.a.createElement("h4",null,"The No. of Cars We Have Pruned: ",this.props.prunedPoints.length),m.a.createElement("table",{className:"table"},m.a.createElement("thead",null,m.a.createElement("tr",null,e)),m.a.createElement("tbody",null,t))),m.a.createElement("div",{className:"col"},m.a.createElement("h4",null,"The No. of Cars Left in the Database: ",this.props.leftPoints.length),m.a.createElement("table",{className:"table"},m.a.createElement("thead",null,m.a.createElement("tr",null,e.slice(1))),m.a.createElement("tbody",null,n))))}}]),t}(m.a.Component),M=Object(h.b)(function(e){return{prunedPoints:e.prunedPoints,leftPoints:e.leftPoints,attributes:e.attributes,mask:e.mask,numQuestions:e.numQuestions}})(_),I=n(36),A=n(27);window.THREE=A,n(55),n(56),n(57);var R=A,L=function(e){function t(){var e,n;Object(p.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(v.a)(this,(e=Object(E.a)(t)).call.apply(e,[this].concat(r)))).drawGeometry=function(){if(!(n.props.vertices<2)){var e=n.props.vertices.map(function(e){return Object(I.a)(R.Vector3,Object(o.a)(e))});if(e.length>3){var t=new R.ConvexGeometry(e),a=new R.MeshBasicMaterial({color:16711680,polygonOffset:!0,polygonOffsetFactor:1,polygonOffsetUnits:1,opacity:.5,transparent:!0});n.mesh=new R.Mesh(t,a);var r=new R.EdgesGeometry(t),s=new R.LineBasicMaterial({color:0,linewidth:2}),i=new R.LineSegments(r,s);n.mesh.add(i)}else{var c=new R.Geometry;e.forEach(function(e){c.vertices.push(e)}),3===e.length&&c.vertices.push(e[0]);var l=new R.LineBasicMaterial({color:0});n.mesh=new R.Line(c,l)}n.scene.add(n.mesh)}},n.start=function(){n.frameId||(n.frameId=window.requestAnimationFrame(n.animate))},n.stop=function(){window.cancelAnimationFrame(n.frameId)},n.animate=function(){n.controls.update(),n.renderer.render(n.scene,n.camera),n.frameId=window.requestAnimationFrame(n.animate)},n}return Object(b.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){var e=this.mount.clientWidth,t=this.mount.clientHeight;this.scene=new R.Scene,this.camera=new R.PerspectiveCamera(75,e/t,.1,10),this.controls=new R.OrbitControls(this.camera,this.mount),this.camera.position.set(1.5,1.5,1.5),this.controls.update(),this.renderer=new R.WebGLRenderer({antialias:!0}),this.renderer.setClearColor(16777215),this.renderer.setSize(e,t),this.mount.appendChild(this.renderer.domElement),this.scene.add(new R.AxesHelper(1.5)),this.start()}},{key:"componentDidUpdate",value:function(e){this.props.vertices!==e.vertices&&(this.mesh&&(this.scene.remove(this.mesh),this.mesh.geometry.dispose(),this.mesh.material.dispose()),this.drawGeometry())}},{key:"componentWillUnmount",value:function(){this.stop(),this.mount.removeChild(this.renderer.domElement)}},{key:"render",value:function(){var e=this;return m.a.createElement("div",{style:{width:"400px",height:"400px",margin:"auto"},ref:function(t){e.mount=t}})}}]),t}(m.a.Component),Q=Object(h.b)(function(e){return{vertices:e.vertices}})(L),D=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(v.a)(this,Object(E.a)(t).call(this,e))).attributes=[],n.props.attributes.forEach(function(e){var t=Object(a.a)(e,2),r=t[0];t[1];n.props.mask[r]&&n.attributes.push(r)}),n}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return 4===this.attributes.length?m.a.createElement("div",{className:"row",style:{minWidth:"1000px"}},m.a.createElement("div",{className:"col-6"},m.a.createElement("h4",null,"No. of Cars Left vs. No. of Questions Asked"),m.a.createElement("div",{className:"d-flex justify-content-center"},m.a.createElement(x,null))),m.a.createElement("div",{className:"col-6"},m.a.createElement("h4",null,"Convex Hull of Preference Plane"),m.a.createElement(Q,null))):m.a.createElement("div",null)}}]),t}(m.a.Component),F=Object(h.b)(function(e){return{attributes:e.attributes,mask:e.mask}})(D);var U=Object(h.b)(function(e){return{activeComponent:e.activeComponent}})(function(e){var t=e.activeComponent;return"Welcome"===t?m.a.createElement(y,null):"Interaction"===t?m.a.createElement("div",null,m.a.createElement(C,null),m.a.createElement(F,null),m.a.createElement(M,null)):"Result"===t?m.a.createElement(S,null):m.a.createElement("div",null)});window.Module={onRuntimeInitialized:function(){var e=new window.Module.Dataset("car.txt"),t=[["Price (USD)",{low:1e3,high:5e4,smallerBetter:!0}],["Year",{low:2001,high:2017,smallerBetter:!1}],["Power (HP)",{low:50,high:400,smallerBetter:!1}],["Used KM",{low:1e4,high:15e4,smallerBetter:!0}]],n={};t.forEach(function(e){var t=Object(a.a)(e,2),r=t[0];t[1];n[r]=1});var o=Object(r.c)(l,{dataset:e,attributes:t,mask:n});Object(d.render)(m.a.createElement(h.a,{store:o},m.a.createElement(U,null)),document.getElementById("root"))}};var V=document.createElement("script");V.src="web.js",V.async=!0,document.body.appendChild(V)}},[[37,2,1]]]);
//# sourceMappingURL=main.fdf20fdc.chunk.js.map